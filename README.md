# Stationary subspace analysis for spatial data

This repositry can be used to reproduce the simulations for the paper: STATIONARY SUBSPACE ANALYSIS FOR SPATIAL DATA

Note that the C-code is taken from the CRAN R-package JADE under the GPL license. The original package can be found at: https://cran.r-project.org/package=JADE

## Initialization

Note that the python code uses interfaced C-code which needs to be compiled separately. Before running any code, one should call ```make``` in the c_src directory. For Linux users, simply run ```./init.sh``` to make the C-files, initialize data directories, and pull the Kola moss and map data. Otherwise, use ```get_kola_data.R```.

## Reproducing simulation results

To reproduce the results seen in the paper, simply call simulations.py with the appropriate flag. The flag -h or --help gives more instructions. For example, to get the results from Simulations 1 for Setting 4, simply run
```
python3 simulations.py -s 4
```
Similarly, the rank estimation results can be generated by running
```
python3 simulations.py -r
```
Note that running the simulations with default values takes multiple hours per setting on a laptop, especially settings 3 and 4. 
By default both of these calls assume that you have installed the relevant packages from the requirements.txt file, and that the following directory structure is in your current working directory:

```
data/
├── kola/
├── rank/
│   └── results/
└── subspace/
    ├── setting1/
    ├── setting2/
    ├── setting3/
    ├── setting4/
    └── results/
```

  ### Description
  
- **data/**  
  Root directory for all datasets and outputs.

- **kola/**  
  Contains the Kola moss and map data.

- **rank/**  
  Contains data and outputs related to rank estimation simulations (Simulation 2).
  - **results/**: Stores result files generated from rank estimation simulations.

- **subspace/**  
  Contains data and outputs related to spSSA simulations (Simulation 1).
  - **setting1–setting4/**: Different settings for parameters and types of nonstationarities.
  - **results/**: Final results from spSSA simulations.
 
## Plotting the results

Once data has been simulated with the above commands, the plots of the paper can be replicated by using the functions from the file plots.py
